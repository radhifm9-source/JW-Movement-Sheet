<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Arrival / Departure Movement Sheet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#eef6ff,#ffffff);
  margin:0;
  padding:16px;
  color:#1f2933;
  box-sizing:border-box;
}
.header{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:8px;
  margin-bottom:16px;
  text-align:center;
}
.header-logo{
  height:48px;
  width:auto;
}
.header-title{
  font-size:20px;
  font-weight:bold;
  color:#003b5c;
}
.card{
  background:#ffffff;
  padding:14px 16px;
  border-radius:10px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.04);
  border:1px solid #e5e7eb;
  border-left:5px solid #003b5c;
}
h3{
  margin:0 0 8px 0;
  color:#003b5c;
  font-size:16px;
}
label{
  font-weight:bold;
  display:block;
  margin-top:10px;
  font-size:13px;
}
input, select, textarea{
  width:100%;
  padding:8px 9px;
  margin-top:4px;
  border-radius:6px;
  border:1px solid #cbd5e1;
  font-size:14px;
  box-sizing:border-box;
}
.count-grid{
  display:grid;
  grid-template-columns:repeat(4, minmax(0, 1fr));
  gap:10px;
}
.preview{
  background:#0f172a;
  color:#22c55e;
  padding:12px;
  border-radius:8px;
  font-family:monospace;
  font-size:13px;
  white-space:pre-line;
  min-height:60px;
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:6px;
  background:#003b5c;
  color:white;
  font-size:15px;
  cursor:pointer;
}
button:active{opacity:0.85;}
@media (max-width:600px){
  .count-grid{grid-template-columns:repeat(2,1fr);}
}
</style>
</head>

<body>

<div class="header">
  <img src="logo.png" class="header-logo">
  <h1 class="header-title">Arrival / Departure Movement Sheet</h1>
</div>

<div class="card">
  <label>Date</label>
  <input type="date" id="date" oninput="updatePreview()">
  <label>Security Officer</label>
  <input type="text" id="officer" oninput="updatePreview()">
  <label>Jetty</label>
  <select id="jetty" onchange="updatePreview()">
    <option>Arrival Jetty</option>
    <option>Supply Jetty</option>
    <option>Hashi Shio Jetty</option>
  </select>
</div>

<!-- ARRIVAL -->
<div class="card">
  <h3>Arrival Movement</h3>
  <input type="time" id="timeArrival" oninput="updatePreview()">
  <div class="count-grid">
    <input type="number" id="crewA" placeholder="Crew" oninput="updatePreview()">
    <input type="number" id="guestsA" placeholder="Guests" oninput="updatePreview()">
    <input type="number" id="associatesA" placeholder="Associates" oninput="updatePreview()">
    <input type="number" id="contractorCountA" placeholder="Contractor / Visitor / Vendor" oninput="updatePreview()">
  </div>
  <input type="text" id="vesselA" placeholder="Vessel / Flight" oninput="updatePreview()">
  <input type="text" id="fromA" placeholder="From" oninput="updatePreview()">
  <input type="text" id="purposeA" placeholder="Purpose" oninput="updatePreview()">
  <textarea id="associateDeptA" placeholder="Associate & Department" oninput="updatePreview()"></textarea>
  <textarea id="contractorA" placeholder="Contractor Details" oninput="updatePreview()"></textarea>
  <input type="text" id="luggageA" placeholder="Luggage" oninput="updatePreview()">
  <textarea id="remarksA" placeholder="Remarks" oninput="updatePreview()"></textarea>
</div>

<!-- DEPARTURE -->
<div class="card">
  <h3>Departure Movement</h3>
  <input type="time" id="timeD" oninput="updatePreview()">
  <div class="count-grid">
    <input type="number" id="crewD" placeholder="Crew" oninput="updatePreview()">
    <input type="number" id="guestsD" placeholder="Guests" oninput="updatePreview()">
    <input type="number" id="associatesD" placeholder="Associates" oninput="updatePreview()">
    <input type="number" id="contractorCountD" placeholder="Contractor / Visitor / Vendor" oninput="updatePreview()">
  </div>
  <input type="text" id="vesselD" placeholder="Vessel / Flight" oninput="updatePreview()">
  <input type="text" id="toD" placeholder="To" oninput="updatePreview()">
  <input type="text" id="purposeD" placeholder="Purpose" oninput="updatePreview()">
  <textarea id="associateDeptD" placeholder="Associate & Department" oninput="updatePreview()"></textarea>
  <textarea id="contractorD" placeholder="Contractor Details" oninput="updatePreview()"></textarea>
  <input type="text" id="luggageD" placeholder="Luggage" oninput="updatePreview()">
  <textarea id="remarksD" placeholder="Remarks" oninput="updatePreview()"></textarea>
</div>

<div class="card">
  <h3>Official Preview</h3>
  <div class="preview" id="preview"></div>
</div>

<div class="card">
  <button onclick="submitMovement()">SUBMIT MOVEMENT</button>
</div>

<script>
var ZAPIER_HOOK_URL = "https://hooks.zapier.com/hooks/catch/25210174/uaw8y0d/";

function trimString(s){return s?s.trim():"";}
function getVal(id){var e=document.getElementById(id);return e?trimString(e.value):"";}

function updatePreview(){
  var msg="";
  if(getVal("date")) msg+="Date: "+getVal("date")+"\n";
  if(getVal("officer")) msg+="Security Officer: "+getVal("officer")+"\n";
  msg+="Jetty: "+getVal("jetty")+"\n";

  if(getVal("timeArrival")){
    msg+="\n--- ARRIVAL ---\n";
    msg+="Time: "+getVal("timeArrival")+"\n";
    msg+="Crew: "+getVal("crewA")+"\n";
    msg+="Guests: "+getVal("guestsA")+"\n";
    msg+="Associates: "+getVal("associatesA")+"\n";
    msg+="Contractor / Visitor / Vendor: "+getVal("contractorCountA")+"\n";
  }

  if(getVal("timeD")){
    msg+="\n--- DEPARTURE ---\n";
    msg+="Time: "+getVal("timeD")+"\n";
    msg+="Crew: "+getVal("crewD")+"\n";
    msg+="Guests: "+getVal("guestsD")+"\n";
    msg+="Associates: "+getVal("associatesD")+"\n";
    msg+="Contractor / Visitor / Vendor: "+getVal("contractorCountD")+"\n";
  }

  document.getElementById("preview").innerText=msg.trim();
}

function submitMovement(){
  if(!document.getElementById("preview").innerText){
    alert("Please fill in movement details.");
    return;
  }
  fetch(ZAPIER_HOOK_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      date:getVal("date"),
      officer:getVal("officer"),
      jetty:getVal("jetty"),
      arrival_associates:getVal("associatesA"),
      arrival_contractors:getVal("contractorCountA"),
      departure_associates:getVal("associatesD"),
      departure_contractors:getVal("contractorCountD"),
      message:document.getElementById("preview").innerText
    })
  });
  alert("Movement submitted successfully.");
  document.querySelectorAll("input,textarea").forEach(e=>e.value="");
  updatePreview();
}
</script>

</body>
</html>

